import{_ as p,r as o,o as r,c as l,a as n,b as a,d as e,e as t}from"./app-148e4e27.js";const c={},i=t(`<h1 id="icloud-secure" tabindex="-1"><a class="header-anchor" href="#icloud-secure" aria-hidden="true">#</a> iCloud secure</h1><p>For getting the iCloud secure URL you have two options: manually using cURL or automatically via kalender-events.</p><p>For both options you have to do the following:</p><h2 id="generate-an-app-specific-password" tabindex="-1"><a class="header-anchor" href="#generate-an-app-specific-password" aria-hidden="true">#</a> Generate an app-specific password</h2><p>Log into your Apple account at appleid.apple.com. Maybe you have to confirm your login by entering the two-factor identification code. As you&#39;re logged in, have a look for &quot;Security&quot; in the Apple ID control panel and click on &quot;Generate Password&quot;.</p><p>Label the app-specific password whatever you want, e.g. &quot;kalender-events&quot; and click &quot;Create&quot;.</p><p><img src="https://github.com/naimo84/kalender-events/raw/docs/docs/examples/generate_password.png" alt="generate_password"></p><p>Apple will provide you with a randomly generated alphanumeric string in the format xxxx-xxxx-xxxx-xxxx. Highlight and copy the password and keep it somewhere safe.</p><p><img src="https://github.com/naimo84/kalender-events/raw/docs/docs/examples/generate_password_2.png" alt="generate_password"></p><h2 id="use-kalender-events" tabindex="-1"><a class="header-anchor" href="#use-kalender-events" aria-hidden="true">#</a> use kalender-events</h2><p>Next open a console. run this (replacing me@icloud.com with your own Apple ID and xxxx-xxxx-xxxx-xxxx with the app-specific password):</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>npx kalender-events-cli icloudurl <span class="token parameter variable">--username</span> me@icloud.com <span class="token parameter variable">--password</span> xxxx-xxxx-xxxx-xxxx 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>the output will look like:</p><div class="language-json line-numbers-mode" data-ext="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  href<span class="token operator">:</span> &#39;https<span class="token operator">:</span><span class="token comment">//p51-caldav.icloud.com:443/123456789/calendars/&#39;,</span>
  list<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> 
      name<span class="token operator">:</span> &#39;Benjamin&#39;<span class="token punctuation">,</span> 
      href<span class="token operator">:</span> &#39;/<span class="token number">123456789</span>/calendars/&#39; <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> &#39;Kalender&#39;<span class="token punctuation">,</span>
      href<span class="token operator">:</span> &#39;/<span class="token number">123456789</span>/calendars/005CEAF5-72EF-4D3B-B6F4-CB2575EC765C/&#39;
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> &#39;Familie&#39;<span class="token punctuation">,</span>
      href<span class="token operator">:</span> &#39;/<span class="token number">123456789</span>/calendars/bef56e45-9bd0-4c66-8c61-faf5d00f2167/&#39;
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> &#39;Familie&#39;<span class="token punctuation">,</span>
      href<span class="token operator">:</span> &#39;/<span class="token number">123456789</span>/calendars/e0b1aa5c-ff01-4c27<span class="token number">-9706</span>-e8f1e397dd11/&#39;
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name<span class="token operator">:</span> &#39;Privat&#39;<span class="token punctuation">,</span> href<span class="token operator">:</span> &#39;/<span class="token number">123456789</span>/calendars/home/&#39; <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name<span class="token operator">:</span> &#39;Erinnerungen&#39;<span class="token punctuation">,</span> href<span class="token operator">:</span> &#39;/<span class="token number">123456789</span>/calendars/tasks/&#39; <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> name<span class="token operator">:</span> &#39;Arbeit&#39;<span class="token punctuation">,</span> href<span class="token operator">:</span> &#39;/<span class="token number">123456789</span>/calendars/work/&#39; <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="manual-using-curl" tabindex="-1"><a class="header-anchor" href="#manual-using-curl" aria-hidden="true">#</a> manual using cURL</h2><p>Next open a console that can run cURL</p><p>run this (replacing me@icloud.com with your own Apple ID):</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token parameter variable">-X</span> PROPFIND <span class="token parameter variable">-u</span> <span class="token string">&quot;me@icloud.com&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;Depth: 0&quot;</span>  <span class="token parameter variable">--data</span> <span class="token string">&quot;&lt;propfind xmlns=&#39;DAV:&#39;&gt;&lt;prop&gt;&lt;current-user-principal/&gt;&lt;/prop&gt;&lt;/propfind&gt;&quot;</span>  https://caldav.icloud.com/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>When propmted for credentials, enter in the app-specific password</p>`,19),d={href:"https://caldav.icloud.com/347723822/principal/",target:"_blank",rel:"noopener noreferrer"},u=t(`<p>Next run this (replacing your numeric ID)</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ <span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token parameter variable">-X</span> PROPFIND <span class="token parameter variable">-u</span> <span class="token string">&quot;<span class="token variable">$APPLEID</span>&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;Depth: 0&quot;</span>  <span class="token parameter variable">--data</span> <span class="token string">&quot;&lt;propfind xmlns=&#39;DAV:&#39; xmlns:cd=&#39;urn:ietf:params:xml:ns:caldav&#39;&gt;&lt;prop&gt;&lt;cd:calendar-home-set/&gt;&lt;/prop&gt;&lt;/propfind&gt;&quot;</span> https://caldav.icloud.com/347723822/principal/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,2),m={href:"https://p22-caldav.icloud.com:443/347723822/calendars",target:"_blank",rel:"noopener noreferrer"},h=t(`<p>You can list all the calendars from your icloud account by running (replacing with your output from above):</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token parameter variable">-X</span> PROPFIND <span class="token parameter variable">-u</span> <span class="token string">&quot;<span class="token variable">$APPLEID</span>&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;Depth: 1&quot;</span>  <span class="token parameter variable">--data</span> <span class="token string">&quot;&lt;propfind xmlns=&#39;DAV:&#39;&gt;&lt;prop&gt;&lt;displayname/&gt;&lt;/prop&gt;&lt;/propfind&gt;&quot;</span>  https://p42-caldav.icloud.com:443/347723822/calendars/ <span class="token operator">|</span> <span class="token function">grep</span> displayname
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>then strip off the grep to show all info about each calendar:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">curl</span> <span class="token parameter variable">-s</span> <span class="token parameter variable">-X</span> PROPFIND <span class="token parameter variable">-u</span> <span class="token string">&quot;<span class="token variable">$APPLEID</span>&quot;</span> <span class="token parameter variable">-H</span> <span class="token string">&quot;Depth: 1&quot;</span>  <span class="token parameter variable">--data</span> <span class="token string">&quot;&lt;propfind xmlns=&#39;DAV:&#39;&gt;&lt;prop&gt;&lt;displayname/&gt;&lt;/prop&gt;&lt;/propfind&gt;&quot;</span>  https://p42-caldav.icloud.com:443/347723822/calendars/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>You may need to up your history buffer depending on the number of calendars you have.</p><p>You are looking for the href value if the calendar you are after eg</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token operator">&lt;</span>href<span class="token operator">&gt;</span>/1317873642/calendars/086e6106-1c0d-4301-a99d-5c5ebbcc5079/<span class="token operator">&lt;</span>/href<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Once you have this, put it together:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>https://p42-caldav.icloud.com:443/347723822/calendars/086e6106-1c0d-4301-a99d-5c5ebbcc5079/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>That&#39;s your calDAV URL 😁</p>`,10),v={href:"https://community.openhab.org/t/solved-apple-icloud-caldav-connection/32510/6",target:"_blank",rel:"noopener noreferrer"};function k(b,g){const s=o("ExternalLinkIcon");return r(),l("div",null,[i,n("p",null,[a("You should get a response and it shows you the URL of your account record. Something like "),n("a",d,[a("https://caldav.icloud.com/347723822/principal/"),e(s)])]),u,n("p",null,[a("This gives you the reference to the cluster the actual calendars lives on. Something like "),n("a",m,[a("https://p22-caldav.icloud.com:443/347723822/calendars"),e(s)])]),h,n("p",null,[a("Thanks to Andrew_Pawelski from the openHab Forum "),n("a",v,[a("https://community.openhab.org/t/solved-apple-icloud-caldav-connection/32510/6"),e(s)]),a(", who wrote this tutorial.")])])}const f=p(c,[["render",k],["__file","icloudsecure.html.vue"]]);export{f as default};
